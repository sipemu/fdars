TARGET = $(subst .dll,.so,$(SHLIB))

# Ensure cargo is in PATH (needed for RStudio)
export PATH := $(HOME)/.cargo/bin:$(PATH)

RUST_SRC = rust
RUST_TARGET_DIR = $(RUST_SRC)/target/release
STATLIB = $(RUST_TARGET_DIR)/libfdars.a

PKG_LIBS = -L$(RUST_TARGET_DIR) -lfdars -lpthread -ldl -lm

OBJECTS = entrypoint.o

all: $(SHLIB)

$(SHLIB): $(STATLIB) $(OBJECTS)

$(STATLIB):
	cd $(RUST_SRC) && cargo build --release --lib

clean:
	rm -Rf $(OBJECTS) $(RUST_SRC)/target
